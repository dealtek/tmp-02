<!DOCTYPE html>
<html>
<head>
<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
<META HTTP-EQUIV="Expires" CONTENT="-1">

<title>Independent Drivers Consortium Title</title>

<!--<meta http-equiv="cache-control" content="no-cache" /> -->
<meta name="viewport" content="width=device-width, initial-scale=1"> 


<link rel="stylesheet" href="inc/jq/themes/theme-02.min.css" />
<link rel="stylesheet" href="inc/jq/themes/jquery.mobile.icons.min.css" />

<link rel="stylesheet" href="https://code.jquery.com/mobile/1.4.5/jquery.mobile.structure-1.4.5.min.css" />
<script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
<script src="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>

<script>
	$(function(){
		$( "[data-role='header'], [data-role='footer']" ).toolbar();
		});
    </script>





<link href="mob.css" rel="stylesheet" type="text/css" />

</head>
<body>


<div data-role="header" data-position="fixed" data-theme="a">
<!--add header -->
</div>

<!-- /header -->

<section id="page01111" data-role="page">

<div role="main" class="ui-content">
<div class="content" >
<div class="box1 center1" >



      
<!--INSERT START -->

<!--!REV - use this to get and set local then go to test display page
 -->



<!--yo <span id="today" ></span> today<br> -->


CHECKING NOW...<br>

Your last test check was: <br>
<span id="lastcheck_test" ></span> <br>



<SCRIPT LANGUAGE="JavaScript">
//function testResults (form) {
	

	//alert("start 1");  
	
	
    //var Client_ID  = form.Client_ID.value;
	//var webpass = form.webpass.value;
   // alert ("You typed: " + Client_ID +" " +webpass);
	
	
	// make pass soon


	//var today = new Date();
//localStorage.setItem('today', today);
lastcheck_test = new Date();
localStorage.setItem('lastcheck_test', lastcheck_test);
//someday.setFullYear(2100, 0, 14);

//document.getElementById('today').textContent = localStorage.getItem("today");

document.getElementById('lastcheck_test').textContent = localStorage.getItem("lastcheck_test");
	
	var Client_ID  = localStorage.getItem("Client_ID");
	//tmp 
	//
	//var Client_ID  = '4502199';	//no test
	//var Client_ID  = '46835';	//found test
	var webpass = localStorage.getItem("cl_emp_Drivers_License_No");
	//
	var socialsec  = localStorage.getItem("cl_emp_Social_Security");
	//cl_emp_Social_Security
	//var socialsec  = '606578533';
	
	


//$.post('https://idcapp.com/app-data/last-drug-test.php', { 	
	/* NOTE THIS IS ONLY FOR DRUG TEST*/
$.post('https://idcapp.com/app-data/get-last-drug-test.php', { 
		Client_ID: Client_ID, 
		socialsec: socialsec,
		webpass: webpass,	
		},
			
function(data, status){

// rev choose between empty array or testid = -1 soon	
	
//alert(" raw data  " + data)	
//alert(" this show lenth yo  " + data.length)	

if (data.Test_ID < 0){
	
//localStorage.setItem('Test_ID', data.Test_ID);
localStorage.setItem('Test_ID', "-1");
// do i need this here
localStorage.setItem("pre_emp_completecheck", "foundzero");
//alert("id  " + data)
//alert("NO TEST FOUND  " + data.Test_ID)
}


//alert("bak is " + data);			
	
//alert("JSON empty111");	

// yo well now I have a test id = 0 so nah - see above
// this could use some cleanup
	
//if (!data[0]) {
	
if (!data[0]) {	
	
// this says if ! not true so false
//alert("JSON empty1a");			
localStorage.setItem('Test_ID', "-1");
// check this
// need for DRUG TEST or any pre employ?
// i guess only found zero is ok but found drug might be randon sooooo	
localStorage.setItem("pre_emp_completecheck", "foundzero");

//alert("JSON empty");	
}else{
//
//alert("JSON found");	
//alert("TEST FOUND  " + data.Test_ID)
// need for DRUG TEST or any pre employ?	
// not for here look just for drug not pre emp
localStorage.setItem("pre_emp_completecheck", "testfound");	
}

//alert("data is " + data);


// dupe idea dump one soon

if(localStorage.getItem("Test_ID") < 1){	

//alert("JSON empty");
// check this
// need for DRUG TEST or any pre employ?	
// not for here 
localStorage.setItem("pre_emp_completecheck", "foundzero");
	
//if(value.Test_ID < 1){	
//alert("Test_ID: is nulll yo" + data + "\nStatus: " + status + " ID is "+localStorage.getItem("Test_ID"));
}else if (localStorage.getItem("Test_ID") > 0){
// need for DRUG TEST or any pre employ?	
// not for here 
localStorage.setItem("pre_emp_completecheck", "testfound");	
//alert("Test_ID: is YUMMER" + data + "\nStatus: " + status);	
	}				

// alert("Data: " + data + "\nStatus: " + status);
console.log ('data', data);
output = "";

$.each(data, function(key, value) {
console. log ('item', key, value);


//output += "<li><a href=\"#\">" + value.Client_ID;  
//output += " " + value.Contact_First + " " + value.Contact_Last + "</a></li>";



//localStorage.setItem("first", value.first + "yum77mm");
//localStorage.setItem("last", value.last + "yum88mm");

if (value.Test_ID > 0){


//localStorage.setItem('Client_ID', value.Client_ID);
localStorage.setItem('last_test_Client_ID', value.Client_ID);
localStorage.setItem('first', value.first);
localStorage.setItem('last', value.last);
localStorage.setItem('Test_Date', value.Test_Date);
localStorage.setItem('Test_Collection_Time', value.Test_Collection_Time);
localStorage.setItem('Date_CCF_Received', value.Date_CCF_Received);
localStorage.setItem('test_report_date', value.test_report_date);
localStorage.setItem('Date_MRO_Spoke_to_worker', value.Date_MRO_Spoke_to_worker);
localStorage.setItem('Speciman_ID_num', value.Speciman_ID_num);
localStorage.setItem('Test_ID', value.Test_ID);
localStorage.setItem('Type', value.Type);
localStorage.setItem('Kind', value.Kind);
localStorage.setItem('Outcome', value.Outcome);
localStorage.setItem('Pos_For_1', value.Pos_For_1);
localStorage.setItem('Pos_For_2', value.Pos_For_2);
localStorage.setItem('Pos_For_3', value.Pos_For_3);
localStorage.setItem('Creatinine', value.Creatinine);
localStorage.setItem('Specific_Gravity', value.Specific_Gravity);
localStorage.setItem('Speciman_out_of_Compliance', value.Speciman_out_of_Compliance);

localStorage.setItem('tests_labs_Name', value.tests_labs_Name);
localStorage.setItem('tests_labs_City', value.tests_labs_City);
localStorage.setItem('tests_labs_State', value.tests_labs_State);
localStorage.setItem('tests_labs_Zip', value.tests_labs_Zip);

localStorage.setItem('tests_col_Name', value.tests_col_Name);
localStorage.setItem('tests_col_Address', value.tests_col_Address);
localStorage.setItem('tests_col_City', value.tests_col_City);
localStorage.setItem('tests_col_State', value.tests_col_State);
localStorage.setItem('tests_col_Zip', value.tests_col_Zip);

localStorage.setItem('tests_sap_Name', value.tests_sap_Name);
localStorage.setItem('tests_sap_Address', value.tests_sap_Address);
localStorage.setItem('tests_sap_City', value.tests_sap_City);
localStorage.setItem('tests_sap_State', value.tests_sap_State);
localStorage.setItem('tests_sap_Zip', value.tests_sap_Zip);
localStorage.setItem('tests_sap_Phone', value.tests_sap_Phone);

// this good fix above stuff
localStorage.setItem("pre_emp_completecheck", "testfound");	

}// end if testid
}
);       
            
//alert("preempch " + localStorage.getItem("pre_emp_completecheck"));

//
window.location.replace("test-results.html");	

}

);
		

	
//} form?
</SCRIPT>




<!--INSERT END -->

</div><!-- end .box -->
</div><!-- end .content -->
</div><!-- /ui-content -->
  
</section><!-- /page -->

<footer data-role="footer" class="ui-barNAH" data-position="fixed" data-theme="a">
<div class="ui-grid-c boxblue">
<!--add footer -->
</div>
</footer>

<!-- /footer -->

</body>
</html>
